## Обзор системы
Простой tcp сервер. Ограничен до 10,000 одновременных соединений с минимальным потреблением ресурсов CPU и памяти.

### Основные технологии:
*   **Язык:** C++20.
*   **I/O Multiplexing:** `epoll` (Linux-specific).
*   **Модель обработки:** Single-threaded Event Loop.
*   **Режим работы сокетов:** Non-blocking + Edge Triggered (ET).

---


# Инструкция по сборке и запуску 

Проект написан на C++20 для систем Linux.

## 1. Требования к системе
Для сборки и запуска вам понадобятся:
*   **ОС:** Linux (ядро 2.6.27+ для поддержки epoll).
*   **Компилятор:** GCC версии 10 или выше (для поддержки стандарта C++20 и библиотеки `<format>`).
*   **Система сборки:** CMake версии 3.10 или выше.
*   **Утилиты:** `make`.

## 2. Структура проекта
```text
.
├── CMakeLists.txt        # Файл конфигурации сборки
├── src
│   ├── server.cpp        # код сервера
│   └── client.cpp        # код клиента
└── README.md             # Текущая инструкция
```

## 3. Сборка проекта

Сборка выполняется в отдельной папке `out`, чтобы не засорять исходный код временными файлами:

```bash
# 1. Создать папку для сборки
mkdir out
cd out

# 2. Сгенерировать Makefile
cmake ..

# 3. Скомпилировать проект
make
```

После успешной компиляции в папке `out` появятся два исполняемых файла: `tcp_server` и `tcp_client`.

---

## 4. Запуск сервера

Сервер принимает один аргумент — номер порта, на котором он будет ожидать подключения.

```bash
./tcp_server <порт>
```

**Пример:**
```bash
./tcp_server 8080
```

Сервер начнет выводить статистику каждую секунду:
*   Количество активных клиентов.
*   Общее число принятых/отправленных сообщений.
*   Количество ошибок и обрывов.

---

## 5. Запуск клиента

Клиент предназначен для стресс-тестирования сервера. Он принимает три аргумента: IP-адрес сервера, порт и количество одновременных соединений `N`.

```bash
./tcp_client <ip_адрес> <порт> <количество_соединений>
```

**Пример:**
```bash
# Запуск 1000 одновременных соединений на локальный адрес
./tcp_client 127.0.0.1 8080 1000
```

---

## 6. Возможные проблемы

1.  **Ошибка "Address already in use":**
    Означает, что порт занят другим процессом или предыдущий запуск сервера еще не полностью очищен ОС. Подождите несколько секунд или смените порт.
    
2.  **Ошибка компиляции (не найден `<format>`):**
    Убедитесь, что ваша версия GCC не ниже 13-й. Если GCC версии 10, 11 или 12, поддержка `std::format` может быть ограничена. В этом случае убедитесь, что в `CMakeLists.txt` указано `set(CMAKE_CXX_STANDARD 20)`.

3.  **Ограничение на количество открытых файлов (ulimit):**
    Если вы хотите протестировать 10,000 соединений, Linux может запретить процессу открывать столько сокетов (обычно лимит 1024). 
    Чтобы увеличить лимит в текущей сессии терминала, выполните:
    ```bash
    ulimit -n 20000
    ```